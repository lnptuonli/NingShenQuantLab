# NingShenQuantLab - AlphaForge Demo1 项目结构文档

## 📋 项目概览

**项目名称：** AlphaForge Demo1 / NingShenQuantLab  
**项目描述：** 量化研究后端调度平台，将 Python 量化工具封装为 API 服务  
**当前阶段：** Spring Boot 学习项目，演示标准的三层架构（Controller、Service、Dao）  
**未来规划：** Python 脚本调度引擎 + Vue 前端可视化  
**技术栈：** Spring Boot 3.2.0 + Java 17 + MySQL 8.0 + MyBatis + JdbcTemplate  

---

## 📂 完整项目结构

```
NingShenQuantLab/
├── src/                                    # 源代码目录
│   ├── main/                              # 主要源代码
│   │   ├── java/                          # Java 源文件
│   │   │   └── com/ningshenquantlab/alphaforge_demo1/
│   │   │       ├── AlphaForgeDemo1Application.java          # ⭐ Spring Boot 主启动类
│   │   │       │
│   │   │       ├── common/                                   # 📦 公共模块
│   │   │       │   ├── PageResult.java                       # 分页结果封装
│   │   │       │   └── Result.java                           # 统一返回结果封装
│   │   │       │
│   │   │       ├── controller/                               # 🎮 控制器层（接收请求、返回响应）
│   │   │       │   ├── HelloController.java                  # Hello 测试控制器
│   │   │       │   ├── UserController.java                   # 用户控制器（旧版）
│   │   │       │   └── UserAcctController.java               # 用户账户控制器（新版）
│   │   │       │
│   │   │       ├── service/                                  # 💼 服务层（业务逻辑）
│   │   │       │   ├── UserService.java                      # 用户服务接口（旧版）
│   │   │       │   ├── UserAcctService.java                  # 用户账户服务接口（新版）
│   │   │       │   └── impl/                                 # 服务实现类
│   │   │       │       ├── UserServiceImpl.java              # 用户服务实现
│   │   │       │       └── UserAcctServiceImpl.java          # 用户账户服务实现
│   │   │       │
│   │   │       ├── dao/                                      # 🗄️ 数据访问层（数据库操作）
│   │   │       │   ├── UserDao.java                          # 用户 DAO 接口（旧版）
│   │   │       │   ├── UserAcctDao.java                      # 用户账户 DAO 接口（新版）
│   │   │       │   └── impl/                                 # DAO 实现类（JdbcTemplate）
│   │   │       │       ├── UserDaoImpl.java                  # 用户 DAO 实现
│   │   │       │       └── UserAcctDaoImpl.java              # 用户账户 DAO 实现
│   │   │       │
│   │   │       ├── mapper/                                   # 🗺️ MyBatis Mapper 接口
│   │   │       │   └── UserAcctMapper.java                   # 用户账户 Mapper 接口
│   │   │       │
│   │   │       ├── entity/                                   # 📊 实体类（对应数据库表）
│   │   │       │   ├── User.java                             # 用户实体（旧版）
│   │   │       │   └── UserAcct.java                         # 用户账户实体（新版）
│   │   │       │
│   │   │       ├── exception/                                # ⚠️ 异常处理模块
│   │   │       │   ├── GlobalExceptionHandler.java           # 全局异常处理器
│   │   │       │   ├── BaseException.java                    # 基础异常类
│   │   │       │   ├── BusinessException.java                # 业务异常
│   │   │       │   ├── ValidationException.java              # 校验异常
│   │   │       │   ├── ResourceNotFoundException.java        # 资源未找到异常
│   │   │       │   ├── UnauthorizedException.java            # 未授权异常
│   │   │       │   └── ForbiddenException.java               # 禁止访问异常
│   │   │       │
│   │   │       ├── validation/                               # ✅ 自定义校验注解
│   │   │       │   ├── CreateGroup.java                      # 创建分组接口
│   │   │       │   ├── UpdateGroup.java                      # 更新分组接口
│   │   │       │   ├── CustKey.java                          # 密码校验注解
│   │   │       │   ├── CustKeyValidator.java                 # 密码校验器
│   │   │       │   ├── ContactCheck.java                     # 联系方式校验注解
│   │   │       │   └── ContactCheckValidator.java            # 联系方式校验器
│   │   │       │
│   │   │       └── init_sql/                                 # 📝 SQL 初始化脚本
│   │   │           ├── db/
│   │   │           │   └── cust_acct                         # 用户账户表建表脚本
│   │   │           └── testdata/
│   │   │               └── cust_acct                         # 测试数据脚本
│   │   │
│   │   └── resources/                                        # 资源文件
│   │       ├── application.yml                               # ⚙️ 应用配置文件（主配置）
│   │       ├── application.properties.example                # 配置文件示例
│   │       ├── application.properties.old                    # 旧版配置文件
│   │       └── mapper/                                       # MyBatis XML 映射文件
│   │           └── UserAcctMapper.xml                        # 用户账户 Mapper XML
│   │
│   └── test/                                                 # 测试代码目录
│       └── java/
│           └── com/ningshenquantlab/alphaforge_demo1/
│               └── AlphaForgeDemo1ApplicationTests.java      # Spring Boot 测试类
│
├── target/                                                   # Maven 编译输出目录（忽略）
│   ├── classes/                                             # 编译后的 class 文件
│   ├── generated-sources/                                   # 自动生成的源代码
│   ├── generated-test-sources/                              # 自动生成的测试源代码
│   ├── maven-status/                                        # Maven 构建状态
│   └── test-classes/                                        # 编译后的测试 class 文件
│
├── pom.xml                                                  # 🔧 Maven 项目配置文件
├── mvnw                                                     # Maven Wrapper (Linux/Mac)
├── mvnw.cmd                                                 # Maven Wrapper (Windows)
├── push_to_github.bat                                       # GitHub 推送脚本
│
└── 📚 文档
    ├── README.md                                            # 项目说明文档
    ├── QUICK_START.md                                       # 快速开始指南
    └── GITHUB_SETUP.md                                      # GitHub 设置指南
```

---

## 🏗️ 架构层次说明

### 1. 控制器层（Controller）
**位置：** `com.ningshenquantlab.alphaforge_demo1.controller`  
**职责：** 
- 接收 HTTP 请求
- 参数校验
- 调用 Service 层处理业务逻辑
- 返回统一格式的响应（`Result`）

**主要类：**
- `HelloController` - 简单的 Hello World 测试接口
- `UserController` - 用户管理接口（旧版，使用 User 实体）
- `UserAcctController` - 用户账户管理接口（新版，使用 UserAcct 实体）

**功能特性：**
- RESTful API 设计
- 统一路径前缀：`/api/v1`
- 支持 CRUD 操作（增删改查）
- 分页查询
- 模糊搜索
- 批量删除

---

### 2. 服务层（Service）
**位置：** `com.ningshenquantlab.alphaforge_demo1.service`  
**职责：**
- 实现核心业务逻辑
- 事务管理（`@Transactional`）
- 调用 DAO 层进行数据操作
- 业务规则校验

**主要类：**
- `UserService` / `UserServiceImpl` - 用户服务（旧版）
- `UserAcctService` / `UserAcctServiceImpl` - 用户账户服务（新版）

**实现特性：**
- 接口与实现分离
- 声明式事务
- 依赖注入（构造器注入）

---

### 3. 数据访问层（DAO/Mapper）
**位置：** `com.ningshenquantlab.alphaforge_demo1.dao`  
**职责：**
- 与数据库交互
- 执行 SQL 语句
- 数据持久化

**技术方案：**

#### 方案一：JdbcTemplate（UserDao、UserAcctDao）
- 使用 Spring JdbcTemplate
- 手动编写 SQL
- 适合简单查询

#### 方案二：MyBatis（UserAcctMapper）
- 使用 MyBatis 框架
- XML 映射文件配置 SQL
- 支持复杂查询和动态 SQL

**主要类：**
- `UserDao` / `UserDaoImpl` - 使用 JdbcTemplate
- `UserAcctDao` / `UserAcctDaoImpl` - 使用 JdbcTemplate
- `UserAcctMapper` - 使用 MyBatis

---

### 4. 实体层（Entity）
**位置：** `com.ningshenquantlab.alphaforge_demo1.entity`  
**职责：**
- 对应数据库表结构
- 封装业务数据

**主要类：**
- `User` - 用户实体（旧版）
  - id（主键）
  - custId（客户 ID）
  - custName（客户姓名）
  - custKey（密码）

- `UserAcct` - 用户账户实体（新版，字段更完整）
  - id（主键）
  - custId（客户 ID）
  - custName（客户姓名）
  - custKey（密码）
  - custEmail（邮箱）
  - custPhone（手机号）
  - status（状态）
  - createTime（创建时间）
  - updateTime（更新时间）

**技术特性：**
- 使用 Lombok 简化代码（`@Data`, `@Builder`, `@NoArgsConstructor`, `@AllArgsConstructor`）
- Bean Validation 注解（`@NotNull`, `@Size`, `@Pattern` 等）
- 自定义校验注解（`@CustKey`, `@ContactCheck`）
- 分组校验（`CreateGroup`, `UpdateGroup`）

---

## 🔧 技术栈详解

### 核心框架
| 技术 | 版本 | 用途 |
|------|------|------|
| Spring Boot | 3.2.0 | 应用框架 |
| Java | 17 | 编程语言 |
| Maven | 3.x | 项目构建管理 |

### 数据库相关
| 技术 | 版本 | 用途 |
|------|------|------|
| MySQL | 8.0 | 关系型数据库 |
| MySQL Connector | 8.0.16 | JDBC 驱动 |
| JdbcTemplate | - | Spring JDBC 模板 |
| MyBatis | 2.3.1 | ORM 框架 |

### Web 相关
| 技术 | 版本 | 用途 |
|------|------|------|
| Spring Web | - | Web MVC 框架 |
| Spring Validation | - | 参数校验 |
| Springfox Swagger | 2.9.2 | API 文档（已配置但未启用）|

### 工具库
| 技术 | 版本 | 用途 |
|------|------|------|
| Lombok | 1.18.42 | 简化 Java 代码 |
| Spring DevTools | - | 热部署、开发工具 |

---

## 📝 主要配置文件说明

### 1. pom.xml
Maven 项目配置文件，定义了：
- 项目坐标（groupId、artifactId、version）
- Java 版本（17）
- Spring Boot 版本（3.2.0）
- 所有依赖库

### 2. application.yml
应用主配置文件，包含：
- **数据源配置**
  - 数据库 URL
  - 用户名/密码
  - 连接池配置
  
- **MyBatis 配置**
  - Mapper XML 位置
  - 类型别名包
  - 下划线转驼峰
  
- **服务器配置**
  - 端口号（8080）
  - 上下文路径
  
- **日志配置**
  - 日志级别

### 3. application.properties.example
配置文件模板，供开发者参考复制

---

## 🛢️ 数据库设计

### 表名：user_acct（用户账户表）

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| id | BIGINT(20) | PRIMARY KEY, AUTO_INCREMENT | 自增主键 |
| cust_id | BIGINT(20) | NOT NULL, UNIQUE | 客户 ID |
| cust_name | VARCHAR(50) | NOT NULL | 客户姓名 |
| cust_key | VARCHAR(100) | NOT NULL | 密码 |
| cust_email | VARCHAR(50) | NULL | 邮箱 |
| cust_phone | VARCHAR(20) | NULL | 手机号 |
| status | TINYINT(1) | DEFAULT 1 | 状态（0-禁用 1-启用）|
| create_time | DATETIME | DEFAULT CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | ON UPDATE CURRENT_TIMESTAMP | 更新时间 |

---

## 🚀 核心功能特性

### 1. 统一返回结果封装（Result）
```java
{
  "code": 200,              // 状态码
  "message": "success",     // 消息
  "data": { ... },          // 数据
  "timestamp": 1234567890   // 时间戳
}
```

### 2. 分页查询（PageResult）
```java
{
  "list": [ ... ],          // 数据列表
  "total": 100,             // 总记录数
  "page": 1,                // 当前页
  "size": 10,               // 每页大小
  "totalPages": 10          // 总页数
}
```

### 3. 参数校验
- **标准校验**：`@NotNull`, `@Size`, `@Pattern`, `@Email`, `@Min`, `@Max`
- **自定义校验**：
  - `@CustKey` - 密码复杂度校验（包含数字、字母、特殊符号）
  - `@ContactCheck` - 联系方式校验（邮箱或手机号至少填一个）
- **分组校验**：`CreateGroup`（创建时）、`UpdateGroup`（更新时）

### 4. 全局异常处理
- `BusinessException` - 业务异常（400）
- `ValidationException` - 校验异常（400）
- `ResourceNotFoundException` - 资源未找到（404）
- `UnauthorizedException` - 未授权（401）
- `ForbiddenException` - 禁止访问（403）

### 5. 事务管理
- 使用 `@Transactional` 注解
- 声明式事务
- 自动回滚

---

## 📡 API 接口列表

### HelloController
| 方法 | 路径 | 说明 |
|------|------|------|
| GET | `/hello` | Hello World 测试接口 |

### UserAcctController
| 方法 | 路径 | 说明 |
|------|------|------|
| GET | `/api/v1/users` | 分页查询用户列表 |
| GET | `/api/v1/users/{custId}` | 根据客户 ID 查询用户 |
| POST | `/api/v1/users` | 创建新用户 |
| PUT | `/api/v1/users/{custId}` | 更新用户信息 |
| DELETE | `/api/v1/users/{custId}` | 删除用户 |
| DELETE | `/api/v1/users?custIds=xxx,xxx` | 批量删除用户 |

---

## 📖 学习要点总结

本项目演示了以下知识点：

1. ✅ **Spring Boot 基础** - 自动配置、启动类、依赖注入
2. ✅ **三层架构** - Controller → Service → Dao 分层设计
3. ✅ **依赖注入** - 构造器注入（推荐方式）
4. ✅ **JdbcTemplate** - Spring JDBC 模板使用
5. ✅ **MyBatis 集成** - Mapper 接口 + XML 配置
6. ✅ **RESTful API** - 统一接口设计规范
7. ✅ **Lombok** - 简化 POJO 代码
8. ✅ **统一返回格式** - Result 封装
9. ✅ **参数校验** - Bean Validation + 自定义校验
10. ✅ **全局异常处理** - @ControllerAdvice
11. ✅ **声明式事务** - @Transactional
12. ✅ **分页查询** - PageResult 封装
13. ✅ **模糊搜索** - LIKE 查询

---

## 🔐 安全注意事项

⚠️ **重要：**
- `application.properties` 包含敏感信息（数据库密码），已被 `.gitignore` 忽略
- 请使用 `application.properties.example` 作为模板
- 不要将包含真实密码的配置文件提交到版本控制系统

---

## 📚 相关文档

- **README.md** - 项目说明和快速开始指南
- **QUICK_START.md** - GitHub 快速上传指南
- **GITHUB_SETUP.md** - GitHub 仓库设置详解
- **量化调度平台架构设计与实施指南.md** - 🚀 Python 脚本调度平台完整架构设计（重要）

---

## 🎯 项目发展规划

### 第一阶段：基础学习（已完成 ✅）
- Spring Boot 三层架构
- RESTful API 设计
- 数据库 CRUD 操作
- 参数校验和异常处理

### 第二阶段：量化调度平台（进行中 🔄）
**目标：** 将 Python 量化工具（特征计算、数据获取、模型训练）封装为 API 服务

**核心功能：**
- Python 脚本执行引擎
- 任务调度和管理
- 异步任务处理
- 任务状态监控
- 日志收集和查看

**详细设计：** 请参阅 **《量化调度平台架构设计与实施指南.md》**

**待办事项：**
1. ⏳ 创建量化业务模块目录结构
2. ⏳ 设计数据库表（任务记录、日志）
3. ⏳ 开发 Python 执行引擎
4. ⏳ 实现特征计算 API
5. ⏳ 开发任务监控和管理功能

### 第三阶段：前端可视化（未来）
- Vue 3 + Element Plus 前端项目
- 任务管理界面
- 实时日志查看
- 数据可视化图表

---

## 📅 文档信息

- **生成日期：** 2025-12-29
- **项目版本：** 0.0.1-SNAPSHOT
- **文档版本：** 2.0
- **最后更新：** 2025-12-29（新增量化平台规划）

---

*此文档由 AI 助手生成和维护。*

